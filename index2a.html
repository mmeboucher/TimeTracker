<html ng-app="goalKeeperApp">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="initial-scale=1.0">
  <title>Goal Tracker Midterm Project 3/23/15 MBoucher</title>
  <link rel="stylesheet" href="css/bootstrap.css">
  <link rel="stylesheet" href="css/style.css">
  
  <script type="text/javascript" src="js/jquery-1.11.2.js"></script>

  <script type="text/javascript" src="js/angular.1.3.14.js"></script>
  <script type="text/javascript" src="js/angular-route.js"></script>


</head>

   </head>
<body ng-controller="MainCtrl">


<div class="cl">
  <h3>Add Your Goals and Hours</h3>
  <div class="panel panel-default">
    <div class="alert alert-danger"
      ng-show="add_portfolio_error != '' ">
      {{ add_portfolio_error }}
    </div>

  <div style="float:left">
        <input 
        type="text" 
        placeholder="yyyy/mm/dd" 
        size="10" 
        required
        ng-model="control.date" />
  </div>
<span class="errormsg" ng-show="control.date.$error.required">
                   Date Required
  </span>
<br><br>

    <ul style="font-size: 18px;">
      <li ng-repeat="name in categories">{{name.goal}} -- number of hours: {{name.hours}}
      <a href="" ng-click="removeName(name)" style="margin-left: 20px; ">remove</a></li>
    </ul>

    <form name= "myform" name="entry_goal" ng-submit="addEntry(adding_entry)" novalidate>

      <input type="text" placeholder="Goal" required ng-model="adding_entry.goal">
      <input type="text" placeholder="hours" required ng-model="adding_entry.hours">

<!--
      the span for required error is not working
-->


  <span class="errormsg" ng-show="myform.entry_goal.$error.required">
                   Entry Required
  </span>
       <!--
         
      <span class="validation-message" ng-show="myform.$invalid">
                    Invalid entry
      </span>


      <input type='submit' value="add" ng-disabled='myform.$invalid'>
      -->
      <input type='submit' value="add">


    </form>

  </div><!-- end of panel-->

  <!--
   <button ng-click="computeCSS()">Compute CSS</button>


<div class="show-colors"  ng-init="mySwitch=true" ng-show="true">

  -->
<div class= "cl">
<div class="color-images" ng-repeat="item in items" ng-show="true" ng-style="computeCSS(item)">
</div>
<!--
      <img style="width:300px; height: 300px;" class="ng-cloak" ng-src="{{ color.imageurl }}" alt="no color">
-->

    </div>


</div><!-- end of show-colors-->

</div><!-- end of cl-->
       <script>
      var nameApp = angular.module('goalKeeperApp', []);



      nameApp.controller('MainCtrl', function ($scope){
        $scope.categories = [
        {goal: 'Family Time', hours: 0}, 
        {goal:'Daily Chores', hours: 0},
        {goal: 'Learn New Skills', hours: 0}
      ];

   $scope.colors = [
        {imageurl: 'img/beigenoise.jpg', displayWidth: '50%'}, 
        {imageurl: 'img/bluenoise.jpg', displayWidth: '30%'} 
      ];



        $scope.add_portfolio_error = "";
        $scope.control= {};


        $scope.addEntry = function(any_name) {

          var input = $scope.adding_entry.goal;
  //        if (!input == "") {
 //           $scope.add_portfolio_error = "entry blank";

  //          return false};
          if (input)
          var inputUpperCase = input.toUpperCase();

          console.log ("user entered = " + input); 
          console.log($scope.categories.length);
 

for (var i = 0; i < $scope.categories.length; i++){

  console.log("i = " + i);

  for (var prop in $scope.categories) {
    var temp = $scope.categories[i]["goal"];
    var tempUpperCase = temp.toUpperCase();


    if (tempUpperCase == inputUpperCase){
          console.log("duplicate found " + input);
          $scope.add_portfolio_error = input + " is a duplicate - pls. correct ";

          return;
      }

    };
};

          if ($scope.myform.$valid){
           $scope.categories.push(any_name);
 //           $scope.categories.push(inputUpperCase);
            console.log($scope.categories);
            console.log('valid form');
            $scope.adding_entry = {};
            $scope.add_portfolio_error = "";

          }
          else {
            console.log('invalid form');
            $scope.add_portfolio_error = "entry error";

            return false;
          };

        };  //end of addEntry


        $scope.removeName = function(name) {
          var i = $scope.categories.indexOf(name);
          $scope.categories.splice(i, 1);
        };
/*
  function is_valid_date (the_date){
    //http://eloquentjavascript.net/09_regexp.html
    if (the_date.match(/^[0-9]{4,4}\/[0-9]{2,2}\/[0-9]{2,2}$/)){
      var d = new Date(the_date);
      return !(isNaN(d.getTime()));
    } else {
      $scope.add_portfolio_error = "invalid date";

      return false;
    };
  };


    $scope.div:'<div style="position:relative; width: 200px; height: 200px; background-color: #646464">' +
                  '<div ng-repeat="item in items" id="{{$index}}" class="my-rectangles" ng-style="computeCSS(item)"></div>' +
              '</div>'
*/

      $scope.computeCSS = function(item) {
        var newWidth = '200px';

        return { 
 //         width: item.width+"px", 
          width: newWidth,
          float: 'left',
          height: '200px',
  //        left: item.left+"px", 
//          top: item.top+"px", 
//          height: item.height+"px", 
          'background-color':item.color
        };
      }
      
      $scope.items = [
        {width: 100, left: 100, top: 100, height: 100, color:'#4C8B71'},
        {width: 100, left: 100, top: 100, height: 100, color:'#F3D698'},
        {width: 100, left: 160, top: 100, height: 100, color:'#D25F45'}
      ];

      

      });   //end of controller 

    </script>

  </body>
</html>

